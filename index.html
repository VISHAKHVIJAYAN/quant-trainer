<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Quant Aptitude Trainer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --bg-color: #0f172a;
            --card-bg: #1e293b;
            --card-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --accent-color: #3b82f6;
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --border-radius: 16px;
            --border-radius-sm: 8px;
            --shadow-lg: 0 20px 40px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 10px 20px rgba(0, 0, 0, 0.2);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            background-image: 
                radial-gradient(at 40% 20%, rgba(99, 102, 241, 0.1) 0px, transparent 50%),
                radial-gradient(at 80% 80%, rgba(139, 92, 246, 0.1) 0px, transparent 50%);
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-gradient);
        }

        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: var(--border-radius);
            text-align: center;
            transition: var(--transition);
            box-shadow: var(--shadow-md);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow-md);
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
            border-color: rgba(99, 102, 241, 0.2);
        }

        .card-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: var(--accent-color);
            font-size: 1.2rem;
        }

        .controls {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 15px;
            margin-bottom: 20px;
        }

        @media (max-width: 640px) {
            .controls {
                grid-template-columns: 1fr;
            }
        }

        select, button, input {
            padding: 14px 18px;
            border-radius: var(--border-radius-sm);
            border: 2px solid transparent;
            background: rgba(30, 41, 59, 0.8);
            color: var(--text-primary);
            font-size: 1rem;
            transition: var(--transition);
        }

        select {
            background: rgba(30, 41, 59, 0.8);
            cursor: pointer;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%233b82f6' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 20px;
            padding-right: 50px;
            appearance: none;
        }

        select:focus, input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }

        button {
            cursor: pointer;
            font-weight: 600;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            white-space: nowrap;
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: white;
            border: none;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
            border: none;
            width: 100%;
        }

        .btn-success:hover {
            background: #0da271;
            transform: translateY(-2px);
        }

        .btn-warning {
            background: var(--warning-color);
            color: white;
            border: none;
        }

        .question-display {
            background: rgba(30, 41, 59, 0.6);
            border-radius: var(--border-radius);
            padding: 40px 30px;
            margin: 30px 0;
            text-align: center;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            border: 2px dashed rgba(59, 130, 246, 0.2);
            transition: var(--transition);
        }

        .question-display:hover {
            border-color: rgba(59, 130, 246, 0.4);
        }

        .input-container {
            position: relative;
            margin: 25px 0;
        }

        .input-container input {
            width: 100%;
            padding: 18px 20px;
            font-size: 1.2rem;
            text-align: center;
            background: rgba(30, 41, 59, 0.8);
            border: 2px solid rgba(59, 130, 246, 0.3);
        }

        .input-container input:focus {
            border-color: var(--accent-color);
            background: rgba(30, 41, 59, 1);
        }

        .hint {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 8px;
            text-align: center;
            display: block;
            font-style: italic;
        }

        .solution-area {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            margin-top: 25px;
            display: none;
            border-left: 5px solid var(--accent-color);
            animation: slideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .solution-correct {
            border-left-color: var(--success-color);
        }

        .solution-incorrect {
            border-left-color: var(--error-color);
        }

        .solution-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .solution-title {
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .steps-container {
            background: rgba(30, 41, 59, 0.6);
            border-radius: var(--border-radius-sm);
            padding: 20px;
            margin-top: 20px;
        }

        .step {
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.95rem;
        }

        .step:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .difficulty-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .difficulty-btn {
            padding: 10px 20px;
            border-radius: 50px;
            background: rgba(30, 41, 59, 0.8);
            border: 2px solid transparent;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        .difficulty-btn.active {
            background: var(--primary-gradient);
            border-color: var(--accent-color);
        }

        .difficulty-btn:hover:not(.active) {
            border-color: rgba(59, 130, 246, 0.5);
        }

        .timer {
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
            padding: 15px;
            background: rgba(30, 41, 59, 0.8);
            border-radius: var(--border-radius);
            margin: 20px 0;
            display: none;
        }

        .progress-bar {
            height: 8px;
            background: rgba(30, 41, 59, 0.8);
            border-radius: 4px;
            margin: 25px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary-gradient);
            width: 0%;
            transition: width 0.5s ease;
        }

        .hidden {
            display: none !important;
        }

        .correct-answer {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--success-color);
            margin: 15px 0;
            padding: 15px;
            background: rgba(16, 185, 129, 0.1);
            border-radius: var(--border-radius-sm);
            border-left: 4px solid var(--success-color);
        }

        .mobile-menu {
            display: none;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: var(--card-bg);
            border-radius: var(--border-radius);
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .question-display {
                padding: 25px 15px;
                font-size: 1.5rem;
                min-height: 150px;
            }
            
            .stat-card {
                padding: 15px;
            }
            
            .stat-value {
                font-size: 1.5rem;
            }
            
            .mobile-menu {
                display: flex;
            }
            
            .desktop-only {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .difficulty-selector {
                justify-content: center;
            }
            
            .card {
                padding: 20px 15px;
            }
        }

        /* MathJax styling */
        .mjx-math {
            font-size: 1.2em !important;
        }

        .math-container {
            padding: 15px;
            background: rgba(30, 41, 59, 0.5);
            border-radius: var(--border-radius-sm);
            margin: 10px 0;
        }

        /* Loading animation */
        .loader {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(59, 130, 246, 0.2);
            border-radius: 50%;
            border-top-color: var(--accent-color);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .feedback-toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: var(--border-radius-sm);
            color: white;
            font-weight: 600;
            z-index: 1000;
            animation: fadeInOut 2s ease;
        }

        .feedback-toast.correct {
            background: var(--success-color);
        }

        .feedback-toast.incorrect {
            background: var(--error-color);
        }

        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateY(-20px); }
            20% { opacity: 1; transform: translateY(0); }
            80% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-20px); }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1><i class="fas fa-brain"></i> Quant Aptitude Trainer</h1>
        <p class="subtitle">Master quantitative aptitude with practice questions</p>
    </header>

    <div class="mobile-menu">
        <div>
            <div class="stat-value" id="mobileScore">0</div>
            <div class="stat-label">Score</div>
        </div>
        <button class="btn-primary" onclick="generateQuestion()">
            <i class="fas fa-redo"></i> New
        </button>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-value" id="score">0</div>
            <div class="stat-label">Score</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="total">0</div>
            <div class="stat-label">Questions</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="streak">0</div>
            <div class="stat-label">Streak</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="accuracy">0%</div>
            <div class="stat-label">Accuracy</div>
        </div>
    </div>

    <div class="card">
        <div class="card-title">
            <i class="fas fa-cog"></i> Settings
        </div>
        
        <div class="difficulty-selector">
            <div class="difficulty-btn active" data-level="easy" onclick="setDifficulty('easy')">
                <i class="fas fa-star"></i> Easy
            </div>
            <div class="difficulty-btn" data-level="medium" onclick="setDifficulty('medium')">
                <i class="fas fa-star"></i><i class="fas fa-star"></i> Medium
            </div>
            <div class="difficulty-btn" data-level="hard" onclick="setDifficulty('hard')">
                <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i> Hard
            </div>
        </div>

        <div class="controls">
            <select id="topicSelect">
                <option value="indices">üìà Indices & Exponents</option>
                <option value="surds">‚àö Surds & Radicals</option>
                <option value="logs">üìä Logarithms</option>
                <option value="linear">üìê Linear Equations</option>
                <option value="quadratic">üéØ Quadratic Equations</option>
                <option value="simultaneous">‚öñÔ∏è Simultaneous Equations</option>
                <option value="arithmetic">üßÆ Arithmetic Progression</option>
            </select>
            <button class="btn-primary" onclick="generateQuestion()" id="genBtn">
                <i class="fas fa-redo"></i> New Question
            </button>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
    </div>

    <div class="timer" id="timer">
        <i class="fas fa-clock"></i> Time: <span id="timeLeft">60</span>s
    </div>

    <div id="gameArea" class="hidden">
        <div class="card">
            <div class="card-title">
                <i class="fas fa-question-circle"></i> Question
            </div>
            <div class="question-display" id="questionText">
                Click "New Question" to start
            </div>
        </div>

        <div class="card">
            <div class="card-title">
                <i class="fas fa-edit"></i> Your Answer
            </div>
            <div class="input-container">
                <input type="text" id="userAnswer" placeholder="Enter your answer here..." autocomplete="off">
                <span class="hint" id="inputHint">Press Enter to submit your answer</span>
            </div>
            <button class="btn-success" onclick="checkAnswer()" id="checkBtn">
                <i class="fas fa-check"></i> Check Answer
            </button>
            <button class="btn-warning" onclick="showHint()" style="margin-top: 10px; width: 100%;">
                <i class="fas fa-lightbulb"></i> Show Hint
            </button>
        </div>
    </div>

    <div class="solution-area" id="solutionBox">
        <div class="solution-header">
            <div class="solution-title" id="solutionStatus">
                <i class="fas fa-solution"></i> Solution
            </div>
            <div id="timeTaken">Time: 0s</div>
        </div>
        
        <div id="answerDisplay" class="correct-answer" style="display: none;">
            Correct Answer: <span id="correctAnswerValue"></span>
        </div>
        
        <div id="steps" class="steps-container"></div>
        
        <div style="display: flex; gap: 10px; margin-top: 20px;">
            <button class="btn-primary" onclick="generateQuestion()" style="flex: 1;">
                <i class="fas fa-forward"></i> Next Question
            </button>
            <button class="btn-warning" onclick="practiceSimilar()" style="flex: 1;">
                <i class="fas fa-redo"></i> Practice Similar
            </button>
        </div>
    </div>

    <div class="card" style="text-align: center; margin-top: 30px;">
        <p style="color: var(--text-secondary); font-size: 0.9rem;">
            <i class="fas fa-info-circle"></i> 
            Press Enter to submit answer ‚Ä¢ Use proper mathematical notation ‚Ä¢ Practice daily for best results
        </p>
    </div>
</div>

<script>
    // Enhanced State Management
    const state = {
        currentTopic: 'indices',
        currentQuestion: null,
        difficulty: 'easy',
        score: 0,
        total: 0,
        correct: 0,
        streak: 0,
        maxStreak: 0,
        startTime: null,
        timerInterval: null,
        timeLimit: 90,
        currentTime: 90,
        hintsUsed: 0
    };

    // DOM Elements
    const els = {
        topic: document.getElementById('topicSelect'),
        question: document.getElementById('questionText'),
        input: document.getElementById('userAnswer'),
        hint: document.getElementById('inputHint'),
        gameArea: document.getElementById('gameArea'),
        solutionBox: document.getElementById('solutionBox'),
        status: document.getElementById('solutionStatus'),
        steps: document.getElementById('steps'),
        score: document.getElementById('score'),
        mobileScore: document.getElementById('mobileScore'),
        total: document.getElementById('total'),
        streak: document.getElementById('streak'),
        accuracy: document.getElementById('accuracy'),
        checkBtn: document.getElementById('checkBtn'),
        genBtn: document.getElementById('genBtn'),
        timer: document.getElementById('timer'),
        timeLeft: document.getElementById('timeLeft'),
        progressFill: document.getElementById('progressFill'),
        answerDisplay: document.getElementById('answerDisplay'),
        correctAnswerValue: document.getElementById('correctAnswerValue'),
        timeTaken: document.getElementById('timeTaken')
    };

    // Math Utilities
    const math = {
        rnd: (min, max) => Math.floor(Math.random() * (max - min + 1)) + min,
        rndItem: (arr) => arr[Math.floor(Math.random() * arr.length)],
        gcd: (a, b) => b === 0 ? Math.abs(a) : math.gcd(b, a % b),
        randomPositiveCoefficient: (min = 1, max = 10) => math.rnd(min, max),
        randomCoefficient: (min = 1, max = 10) => {
            const val = math.rnd(min, max);
            return Math.random() > 0.5 ? val : -val;
        },
        // Find largest perfect square factor
        largestPerfectSquareFactor: (n) => {
            let largest = 1;
            for (let i = 2; i * i <= n; i++) {
                while (n % (i * i) === 0) {
                    largest *= i;
                    n /= (i * i);
                }
            }
            return { perfectSquareRoot: largest, remainder: n };
        },
        // Format coefficient for display
        formatCoeff: (coeff, isFirst = false) => {
            if (coeff === 0) return '';
            if (coeff === 1) return isFirst ? '' : '+ ';
            if (coeff === -1) return isFirst ? '-' : '- ';
            if (coeff > 0) return isFirst ? `${coeff}` : `+ ${coeff}`;
            return isFirst ? `${coeff}` : `- ${Math.abs(coeff)}`;
        },
        // Format term for equations
        formatTerm: (coeff, variable, isFirst = false) => {
            if (coeff === 0) return '';
            const sign = coeff >= 0 ? (isFirst ? '' : ' + ') : (isFirst ? '-' : ' - ');
            const absCoeff = Math.abs(coeff);
            const coeffStr = absCoeff === 1 ? '' : absCoeff;
            return `${sign}${coeffStr}${variable}`;
        }
    };

    // Enhanced Generators - All Fixed
    const generators = {
        indices: () => {
            const difficultyConfig = {
                easy: { baseRange: [2, 5], expRange: [1, 3], types: [1, 2] },
                medium: { baseRange: [2, 7], expRange: [1, 5], types: [1, 2, 3] },
                hard: { baseRange: [2, 9], expRange: [1, 6], types: [1, 2, 3, 4] }
            };
            
            const config = difficultyConfig[state.difficulty];
            const base = math.rnd(...config.baseRange);
            const type = math.rndItem(config.types);
            let latex, answer, steps = [];
            
            if (type === 1) {
                // Multiplication and division: a^m √ó a^n √∑ a^p
                const e1 = math.rnd(...config.expRange);
                const e2 = math.rnd(...config.expRange);
                const e3 = math.rnd(1, Math.min(e1 + e2 - 1, config.expRange[1]));
                const resultExp = e1 + e2 - e3;
                
                latex = `${base}^{${e1}} \\times ${base}^{${e2}} \\div ${base}^{${e3}}`;
                answer = Math.pow(base, resultExp);
                steps = [
                    `Apply multiplication rule: $a^m \\times a^n = a^{m+n}$`,
                    `$${base}^{${e1}} \\times ${base}^{${e2}} = ${base}^{${e1}+${e2}} = ${base}^{${e1+e2}}$`,
                    `Apply division rule: $a^m \\div a^n = a^{m-n}$`,
                    `$${base}^{${e1+e2}} \\div ${base}^{${e3}} = ${base}^{${e1+e2}-${e3}} = ${base}^{${resultExp}}$`,
                    `Calculate: $${base}^{${resultExp}} = ${answer}$`
                ];
            } else if (type === 2) {
                // Power of power: (a^m)^n
                const e1 = math.rnd(1, 3);
                const e2 = math.rnd(2, 3);
                const resultExp = e1 * e2;
                
                latex = `(${base}^{${e1}})^{${e2}}`;
                answer = Math.pow(base, resultExp);
                steps = [
                    `Apply power rule: $(a^m)^n = a^{m \\times n}$`,
                    `$(${base}^{${e1}})^{${e2}} = ${base}^{${e1} \\times ${e2}}$`,
                    `$= ${base}^{${resultExp}}$`,
                    `Calculate: $${base}^{${resultExp}} = ${answer}$`
                ];
            } else if (type === 3) {
                // nth root as fractional exponent
                const n = math.rnd(2, 3);
                const e1 = math.rnd(1, 3);
                const innerExp = e1 * n;
                
                latex = `\\sqrt[${n}]{${base}^{${innerExp}}}`;
                answer = Math.pow(base, e1);
                steps = [
                    `Convert root to fractional exponent: $\\sqrt[n]{a^m} = a^{m/n}$`,
                    `$\\sqrt[${n}]{${base}^{${innerExp}}} = ${base}^{${innerExp}/${n}}$`,
                    `$= ${base}^{${e1}}$`,
                    `Calculate: $${base}^{${e1}} = ${answer}$`
                ];
            } else {
                // Different bases multiplication
                const base2 = math.rnd(2, 5);
                const e1 = math.rnd(2, 3);
                const e2 = math.rnd(2, 3);
                const val1 = Math.pow(base, e1);
                const val2 = Math.pow(base2, e2);
                
                latex = `${base}^{${e1}} \\times ${base2}^{${e2}}`;
                answer = val1 * val2;
                steps = [
                    `Calculate each term separately:`,
                    `$${base}^{${e1}} = ${val1}$`,
                    `$${base2}^{${e2}} = ${val2}$`,
                    `Multiply: $${val1} \\times ${val2} = ${answer}$`
                ];
            }
            
            return {
                latex,
                answer: answer,
                answerDisplay: answer.toString(),
                steps,
                hint: "Enter the numerical value",
                type: "indices"
            };
        },

        surds: () => {
            const difficultyConfig = {
                easy: { 
                    simplifyNums: [8, 12, 18, 20, 27, 32, 45, 48, 50],
                    types: [1]
                },
                medium: { 
                    simplifyNums: [8, 12, 18, 20, 27, 32, 45, 48, 50, 72, 75, 98],
                    types: [1, 2]
                },
                hard: { 
                    simplifyNums: [32, 45, 48, 50, 72, 75, 98, 108, 125, 128, 147, 162],
                    types: [1, 2, 3]
                }
            };
            
            const config = difficultyConfig[state.difficulty];
            const type = math.rndItem(config.types);
            let latex, answer, answerDisplay, steps = [];
            
            if (type === 1) {
                // Simplify ‚àön
                const num = math.rndItem(config.simplifyNums);
                const { perfectSquareRoot, remainder } = math.largestPerfectSquareFactor(num);
                
                latex = `\\text{Simplify: } \\sqrt{${num}}`;
                
                if (perfectSquareRoot === 1) {
                    answer = Math.sqrt(num);
                    answerDisplay = `‚àö${num}`;
                    steps = [
                        `$\\sqrt{${num}}$ has no perfect square factors`,
                        `It is already in simplest form: $\\sqrt{${num}}$`
                    ];
                } else {
                    const perfectSquare = perfectSquareRoot * perfectSquareRoot;
                    answer = perfectSquareRoot; // Coefficient
                    answerDisplay = perfectSquareRoot === 1 ? `‚àö${remainder}` : `${perfectSquareRoot}‚àö${remainder}`;
                    
                    steps = [
                        `Find perfect square factors of ${num}:`,
                        `$${num} = ${perfectSquare} \\times ${remainder}$`,
                        `$\\sqrt{${num}} = \\sqrt{${perfectSquare} \\times ${remainder}}$`,
                        `$= \\sqrt{${perfectSquare}} \\times \\sqrt{${remainder}}$`,
                        `$= ${perfectSquareRoot}\\sqrt{${remainder}}$`
                    ];
                }
                
                return {
                    latex,
                    answer: answerDisplay,
                    answerDisplay,
                    remainder: remainder,
                    coefficient: perfectSquareRoot,
                    steps,
                    hint: `Enter as coefficient‚àöremainder (e.g., 3‚àö2) or just ‚àön`,
                    type: "surds",
                    subtype: "simplify"
                };
            } else if (type === 2) {
                // Rationalize denominator: n/‚àöd
                const d = math.rndItem([2, 3, 5, 6, 7]);
                const multiplier = math.rnd(1, 4);
                const n = d * multiplier;
                
                latex = `\\text{Rationalize: } \\frac{${n}}{\\sqrt{${d}}}`;
                answerDisplay = multiplier === 1 ? `‚àö${d}` : `${multiplier}‚àö${d}`;
                answer = multiplier;
                
                steps = [
                    `Multiply numerator and denominator by $\\sqrt{${d}}$:`,
                    `$\\frac{${n}}{\\sqrt{${d}}} \\times \\frac{\\sqrt{${d}}}{\\sqrt{${d}}}$`,
                    `$= \\frac{${n}\\sqrt{${d}}}{${d}}$`,
                    `$= ${multiplier === 1 ? '' : multiplier}\\sqrt{${d}}$`
                ];
                
                return {
                    latex,
                    answer: answerDisplay,
                    answerDisplay,
                    remainder: d,
                    coefficient: multiplier,
                    steps,
                    hint: `Enter as coefficient‚àöremainder (e.g., 2‚àö3)`,
                    type: "surds",
                    subtype: "rationalize"
                };
            } else {
                // Multiply surds: ‚àöa √ó ‚àöb
                const a = math.rndItem([2, 3, 5, 6, 7]);
                const b = math.rndItem([2, 3, 5, 6, 8]);
                const product = a * b;
                const { perfectSquareRoot, remainder } = math.largestPerfectSquareFactor(product);
                
                latex = `\\text{Simplify: } \\sqrt{${a}} \\times \\sqrt{${b}}`;
                
                if (perfectSquareRoot === 1) {
                    answerDisplay = `‚àö${product}`;
                } else if (remainder === 1) {
                    answerDisplay = `${perfectSquareRoot}`;
                } else {
                    answerDisplay = `${perfectSquareRoot}‚àö${remainder}`;
                }
                answer = perfectSquareRoot;
                
                steps = [
                    `Apply rule: $\\sqrt{a} \\times \\sqrt{b} = \\sqrt{ab}$`,
                    `$\\sqrt{${a}} \\times \\sqrt{${b}} = \\sqrt{${a} \\times ${b}} = \\sqrt{${product}}$`,
                    perfectSquareRoot > 1 ? `Simplify: $\\sqrt{${product}} = ${answerDisplay}$` : `$\\sqrt{${product}}$ is already simplified`
                ];
                
                return {
                    latex,
                    answer: answerDisplay,
                    answerDisplay,
                    remainder: remainder,
                    coefficient: perfectSquareRoot,
                    steps,
                    hint: `Enter as coefficient‚àöremainder or just ‚àön or just a number`,
                    type: "surds",
                    subtype: "multiply"
                };
            }
        },

        logs: () => {
            const difficultyConfig = {
                easy: { baseRange: [2, 5], powerRange: [1, 4], types: [1, 4] },
                medium: { baseRange: [2, 8], powerRange: [1, 5], types: [1, 3, 4] },
                hard: { baseRange: [2, 10], powerRange: [1, 6], types: [1, 2, 3, 4] }
            };
            
            const config = difficultyConfig[state.difficulty];
            const type = math.rndItem(config.types);
            let latex, answer, steps = [];
            
            if (type === 1) {
                // Basic: log_b(b^n) = n
                const base = math.rnd(...config.baseRange);
                const power = math.rnd(...config.powerRange);
                const value = Math.pow(base, power);
                
                latex = `\\log_{${base}} ${value}`;
                answer = power;
                steps = [
                    `We need to find $x$ such that $${base}^x = ${value}$`,
                    `Since $${base}^{${power}} = ${value}$`,
                    `Therefore, $\\log_{${base}} ${value} = ${power}$`
                ];
            } else if (type === 2) {
                // Log addition: log(a) + log(b) = log(ab)
                const base = 10;
                const a = math.rnd(2, 5);
                const b = math.rnd(2, 5);
                const product = a * b;
                
                latex = `\\log ${a} + \\log ${b}`;
                answer = product;
                steps = [
                    `Apply product rule: $\\log a + \\log b = \\log(ab)$`,
                    `$\\log ${a} + \\log ${b} = \\log(${a} \\times ${b})$`,
                    `$= \\log ${product}$`,
                    `Answer: $\\log ${product}$ (or enter ${product} as the argument)`
                ];
            } else if (type === 3) {
                // Solve for x: log_b(x) = n
                const base = math.rnd(2, 5);
                const power = math.rnd(2, 4);
                
                latex = `\\text{If } \\log_{${base}} x = ${power}, \\text{ find } x`;
                answer = Math.pow(base, power);
                steps = [
                    `Convert to exponential form:`,
                    `$\\log_{${base}} x = ${power}$ means $${base}^{${power}} = x$`,
                    `$x = ${base}^{${power}} = ${Math.pow(base, power)}$`
                ];
            } else {
                // Direct: log_a(a^b)
                const base = math.rnd(2, 6);
                const exp = math.rnd(2, 4);
                const value = Math.pow(base, exp);
                
                latex = `\\log_{${base}} ${value}`;
                answer = exp;
                steps = [
                    `Find what power of ${base} gives ${value}:`,
                    `$${base}^{?} = ${value}$`,
                    `$${base}^{${exp}} = ${value}$`,
                    `Therefore, $\\log_{${base}} ${value} = ${exp}$`
                ];
            }
            
            return {
                latex,
                answer,
                answerDisplay: answer.toString(),
                steps,
                hint: "Enter the numerical value",
                type: "logs"
            };
        },

        linear: () => {
            const difficultyConfig = {
                easy: { coeffRange: [2, 6], constRange: [1, 10], xRange: [1, 5] },
                medium: { coeffRange: [2, 9], constRange: [-10, 10], xRange: [-5, 5] },
                hard: { coeffRange: [2, 12], constRange: [-15, 15], xRange: [-8, 8] }
            };
            
            const config = difficultyConfig[state.difficulty];
            
            // Generate equation: ax + b = c where x is the solution
            const a = math.rnd(...config.coeffRange) * (Math.random() > 0.3 ? 1 : -1);
            const x = math.rnd(...config.xRange);
            const b = math.rnd(...config.constRange);
            const c = a * x + b;
            
            // Format equation properly
            const aStr = a === 1 ? '' : (a === -1 ? '-' : a);
            const bStr = b >= 0 ? `+ ${b}` : `- ${Math.abs(b)}`;
            
            const latex = `${aStr}x ${bStr} = ${c}`;
            const answer = x;
            
            const steps = [
                `Given equation: $${aStr}x ${bStr} = ${c}$`,
                `Step 1: Move constant to right side`,
                `$${aStr}x = ${c} ${b >= 0 ? '-' : '+'} ${Math.abs(b)}$`,
                `$${aStr}x = ${c - b}$`,
                `Step 2: Divide both sides by ${a}`,
                `$x = \\frac{${c - b}}{${a}} = ${x}$`
            ];
            
            return {
                latex: `\\text{Solve: } ${latex}`,
                answer,
                answerDisplay: answer.toString(),
                steps,
                hint: "Enter the value of x",
                type: "linear"
            };
        },

        quadratic: () => {
            const difficultyConfig = {
                easy: { rootRange: [-4, 4] },
                medium: { rootRange: [-6, 6] },
                hard: { rootRange: [-8, 8] }
            };
            
            const config = difficultyConfig[state.difficulty];
            
            // Generate integer roots
            let r1 = math.rnd(...config.rootRange);
            let r2 = math.rnd(...config.rootRange);
            
            // Ensure distinct non-zero roots for cleaner problems
            while (r1 === r2 || r1 === 0 || r2 === 0) {
                r1 = math.rnd(...config.rootRange);
                r2 = math.rnd(...config.rootRange);
            }
            
            // x¬≤ - (r1+r2)x + r1*r2 = 0
            const b = -(r1 + r2);
            const c = r1 * r2;
            
            // Build equation string properly
            let equation = 'x^2';
            if (b !== 0) {
                equation += b > 0 ? ` + ${b}x` : ` - ${Math.abs(b)}x`;
            }
            if (c !== 0) {
                equation += c > 0 ? ` + ${c}` : ` - ${Math.abs(c)}`;
            }
            equation += ' = 0';
            
            const roots = [r1, r2].sort((a, b) => a - b);
            const answer = roots.join(', ');
            
            const discriminant = b * b - 4 * c;
            
            const steps = [
                `Given: $${equation}$`,
                `Here $a = 1, b = ${b}, c = ${c}$`,
                `Discriminant: $\\Delta = b^2 - 4ac = (${b})^2 - 4(1)(${c}) = ${discriminant}$`,
                `Using quadratic formula: $x = \\frac{-b \\pm \\sqrt{\\Delta}}{2a}$`,
                `$x = \\frac{${-b} \\pm \\sqrt{${discriminant}}}{2}$`,
                `$x = \\frac{${-b} \\pm ${Math.sqrt(discriminant)}}{2}$`,
                `$x_1 = \\frac{${-b} + ${Math.sqrt(discriminant)}}{2} = ${Math.max(r1, r2)}$`,
                `$x_2 = \\frac{${-b} - ${Math.sqrt(discriminant)}}{2} = ${Math.min(r1, r2)}$`,
                `Roots: $x = ${roots[0]}, ${roots[1]}$`
            ];
            
            return {
                latex: `\\text{Solve: } ${equation}`,
                answer,
                answerDisplay: answer,
                roots: roots,
                steps,
                hint: "Enter both roots separated by comma (smaller first), e.g., -3, 2",
                type: "quadratic"
            };
        },

        simultaneous: () => {
            const difficultyConfig = {
                easy: { coeffRange: [1, 4], solRange: [1, 5] },
                medium: { coeffRange: [1, 6], solRange: [-5, 5] },
                hard: { coeffRange: [1, 8], solRange: [-7, 7] }
            };
            
            const config = difficultyConfig[state.difficulty];
            
            // Generate solution first
            const x = math.rnd(...config.solRange);
            const y = math.rnd(...config.solRange);
            
            // Generate coefficients (avoid zero and ensure solvable)
            let a1, b1, a2, b2;
            do {
                a1 = math.rnd(1, config.coeffRange[1]) * (Math.random() > 0.5 ? 1 : -1);
                b1 = math.rnd(1, config.coeffRange[1]) * (Math.random() > 0.5 ? 1 : -1);
                a2 = math.rnd(1, config.coeffRange[1]) * (Math.random() > 0.5 ? 1 : -1);
                b2 = math.rnd(1, config.coeffRange[1]) * (Math.random() > 0.5 ? 1 : -1);
            } while (a1 * b2 === a2 * b1); // Ensure unique solution
            
            const c1 = a1 * x + b1 * y;
            const c2 = a2 * x + b2 * y;
            
            // Format equations properly
            const formatEq = (a, b, c) => {
                let eq = '';
                // x term
                if (a === 1) eq += 'x';
                else if (a === -1) eq += '-x';
                else eq += `${a}x`;
                // y term
                if (b === 1) eq += ' + y';
                else if (b === -1) eq += ' - y';
                else if (b > 0) eq += ` + ${b}y`;
                else eq += ` - ${Math.abs(b)}y`;
                eq += ` = ${c}`;
                return eq;
            };
            
            const eq1 = formatEq(a1, b1, c1);
            const eq2 = formatEq(a2, b2, c2);
            
            const latex = `\\begin{cases} ${eq1} \\\\ ${eq2} \\end{cases}`;
            const answer = `x=${x}, y=${y}`;
            
            const steps = [
                `Equation 1: $${eq1}$`,
                `Equation 2: $${eq2}$`,
                `Using substitution or elimination method:`,
                `From the equations, solve for x and y`,
                `Solution: $x = ${x}, y = ${y}$`,
                `Verify: ${a1}(${x}) + ${b1}(${y}) = ${c1} ‚úì`,
                `Verify: ${a2}(${x}) + ${b2}(${y}) = ${c2} ‚úì`
            ];
            
            return {
                latex: `\\text{Solve: } ${latex}`,
                answer,
                answerDisplay: answer,
                x: x,
                y: y,
                steps,
                hint: "Enter as: x=value, y=value (e.g., x=2, y=-3)",
                type: "simultaneous"
            };
        },

        arithmetic: () => {
            const difficultyConfig = {
                easy: { aRange: [1, 5], dRange: [2, 4], nRange: [5, 10], types: [1, 2] },
                medium: { aRange: [1, 10], dRange: [-5, 5], nRange: [8, 15], types: [1, 2, 3] },
                hard: { aRange: [-5, 10], dRange: [-8, 8], nRange: [10, 20], types: [1, 2, 3] }
            };
            
            const config = difficultyConfig[state.difficulty];
            const type = math.rndItem(config.types);
            
            // Generate AP parameters
            const a = math.rnd(...config.aRange);
            let d = math.rnd(...config.dRange);
            if (d === 0) d = 2; // Avoid d=0
            
            let latex, answer, steps = [];
            
            if (type === 1) {
                // Find sum of n terms
                const n = math.rnd(...config.nRange);
                const sum = (n / 2) * (2 * a + (n - 1) * d);
                
                latex = `\\text{Find } S_{${n}} \\text{ of AP: } ${a}, ${a + d}, ${a + 2*d}, ...`;
                answer = sum;
                steps = [
                    `First term $a = ${a}$, Common difference $d = ${d}$`,
                    `Sum formula: $S_n = \\frac{n}{2}[2a + (n-1)d]$`,
                    `$S_{${n}} = \\frac{${n}}{2}[2(${a}) + (${n}-1)(${d})]$`,
                    `$= \\frac{${n}}{2}[${2*a} + ${(n-1)*d}]$`,
                    `$= \\frac{${n}}{2} \\times ${2*a + (n-1)*d}$`,
                    `$= ${sum}$`
                ];
            } else if (type === 2) {
                // Find nth term
                const n = math.rnd(...config.nRange);
                const term = a + (n - 1) * d;
                
                latex = `\\text{Find } T_{${n}} \\text{ of AP: } ${a}, ${a + d}, ${a + 2*d}, ...`;
                answer = term;
                steps = [
                    `First term $a = ${a}$, Common difference $d = ${d}$`,
                    `nth term formula: $T_n = a + (n-1)d$`,
                    `$T_{${n}} = ${a} + (${n}-1)(${d})$`,
                    `$= ${a} + ${(n-1)*d}$`,
                    `$= ${term}$`
                ];
            } else {
                // Find n given sum
                const n = math.rnd(5, 12);
                const term = a + (n - 1) * d;
                
                latex = `\\text{In AP with } a=${a}, d=${d}, \\text{ which term is } ${term}?`;
                answer = n;
                steps = [
                    `Given: $a = ${a}, d = ${d}$, find $n$ where $T_n = ${term}$`,
                    `Using: $T_n = a + (n-1)d$`,
                    `$${term} = ${a} + (n-1)(${d})$`,
                    `$${term - a} = (n-1)(${d})$`,
                    `$n - 1 = ${(term - a) / d}$`,
                    `$n = ${n}$`
                ];
            }
            
            return {
                latex,
                answer,
                answerDisplay: answer.toString(),
                steps,
                hint: "Enter the numerical value",
                type: "arithmetic"
            };
        }
    };

    // Core Functions
    function generateQuestion() {
        resetTimer();
        els.solutionBox.style.display = 'none';
        els.answerDisplay.style.display = 'none';
        els.input.value = '';
        els.checkBtn.disabled = false;
        els.gameArea.classList.remove('hidden');
        els.timer.style.display = 'block';
        
        state.currentTopic = els.topic.value;
        const generator = generators[state.currentTopic];
        
        try {
            state.currentQuestion = generator();
            
            // Format question with MathJax
            els.question.innerHTML = `\\[${state.currentQuestion.latex}\\]`;
            
            // Update hint
            els.hint.textContent = state.currentQuestion.hint;
            
            // Start timer
            startTimer();
            
            // Update progress
            updateProgress();
            
            // Render MathJax
            if (window.MathJax && MathJax.typesetPromise) {
                MathJax.typesetPromise([els.question]).catch(err => console.log('MathJax error:', err));
            }
            
            // Focus input
            setTimeout(() => els.input.focus(), 300);
        } catch (e) {
            console.error("Generator Error:", e);
            els.question.innerHTML = "Error generating question. Please try again.";
        }
    }

    function checkAnswer() {
        if (!state.currentQuestion) return;
        
        clearInterval(state.timerInterval);
        els.timer.style.display = 'none';
        els.checkBtn.disabled = true;
        
        const userInput = els.input.value.trim().toLowerCase();
        let isCorrect = false;
        
        // Calculate time taken
        const timeTaken = Math.max(0, state.timeLimit - state.currentTime);
        els.timeTaken.textContent = `Time: ${timeTaken}s`;
        
        // Validation based on question type
        const q = state.currentQuestion;
        
        if (q.type === 'quadratic') {
            // Parse user roots
            const userRoots = userInput.split(',').map(s => parseFloat(s.trim())).filter(n => !isNaN(n)).sort((a, b) => a - b);
            const correctRoots = q.roots;
            
            if (userRoots.length === 2) {
                isCorrect = Math.abs(userRoots[0] - correctRoots[0]) < 0.01 &&
                           Math.abs(userRoots[1] - correctRoots[1]) < 0.01;
            }
        } else if (q.type === 'simultaneous') {
            // Parse x=value, y=value format
            const xMatch = userInput.match(/x\s*=\s*([-\d.]+)/i);
            const yMatch = userInput.match(/y\s*=\s*([-\d.]+)/i);
            
            if (xMatch && yMatch) {
                const userX = parseFloat(xMatch[1]);
                const userY = parseFloat(yMatch[1]);
                isCorrect = Math.abs(userX - q.x) < 0.01 && Math.abs(userY - q.y) < 0.01;
            }
        } else if (q.type === 'surds') {
            // Normalize surd input
            const normalized = userInput
                .replace(/‚àö/g, 'sqrt')
                .replace(/\s+/g, '')
                .toLowerCase();
            
            // Try multiple formats
            const expectedFormats = [
                q.answerDisplay.toLowerCase().replace(/‚àö/g, 'sqrt').replace(/\s+/g, ''),
                `${q.coefficient}sqrt${q.remainder}`,
                `${q.coefficient}sqrt(${q.remainder})`,
                `sqrt${q.remainder}`,
                `sqrt(${q.remainder})`
            ];
            
            // Check if coefficient is 1
            if (q.coefficient === 1) {
                expectedFormats.push(`sqrt${q.remainder}`);
                expectedFormats.push(`sqrt(${q.remainder})`);
            }
            
            // Check if remainder is 1 (perfect square result)
            if (q.remainder === 1) {
                expectedFormats.push(q.coefficient.toString());
            }
            
            isCorrect = expectedFormats.some(fmt => normalized === fmt.toLowerCase().replace(/\s+/g, ''));
            
            // Also check numerical if it's a perfect result
            if (!isCorrect && q.remainder === 1) {
                isCorrect = parseFloat(userInput) === q.coefficient;
            }
        } else {
            // Numerical comparison
            const userNum = parseFloat(userInput);
            const correctNum = parseFloat(q.answer);
            isCorrect = !isNaN(userNum) && Math.abs(userNum - correctNum) < 0.01;
        }
        
        // Update stats
        state.total++;
        if (isCorrect) {
            state.score += Math.max(1, Math.floor((state.timeLimit - timeTaken) / 10));
            state.correct++;
            state.streak++;
            if (state.streak > state.maxStreak) {
                state.maxStreak = state.streak;
            }
            showFeedback(true);
        } else {
            state.streak = 0;
            showFeedback(false);
        }
        
        updateStats();
        showSolution(isCorrect);
    }

    function showFeedback(isCorrect) {
        const toast = document.createElement('div');
        toast.className = `feedback-toast ${isCorrect ? 'correct' : 'incorrect'}`;
        toast.innerHTML = isCorrect ? 
            '<i class="fas fa-check-circle"></i> Correct!' : 
            '<i class="fas fa-times-circle"></i> Incorrect';
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 2000);
    }

    function showSolution(isCorrect) {
        els.solutionBox.style.display = 'block';
        els.solutionBox.className = 'solution-area ' + (isCorrect ? 'solution-correct' : 'solution-incorrect');
        
        if (isCorrect) {
            els.status.innerHTML = '<i class="fas fa-check-circle" style="color: var(--success-color)"></i> Correct!';
            els.answerDisplay.style.display = 'none';
        } else {
            els.status.innerHTML = '<i class="fas fa-times-circle" style="color: var(--error-color)"></i> Incorrect';
            els.answerDisplay.style.display = 'block';
            els.correctAnswerValue.textContent = state.currentQuestion.answerDisplay;
        }
        
        // Display steps
        if (state.currentQuestion.steps) {
            const stepsHtml = state.currentQuestion.steps.map(step => 
                `<div class="step">${step}</div>`
            ).join('');
            els.steps.innerHTML = stepsHtml;
            
            // Render MathJax in steps
            if (window.MathJax && MathJax.typesetPromise) {
                MathJax.typesetPromise([els.steps]).catch(err => console.log('MathJax error:', err));
            }
        }
        
        updateProgress();
        
        // Scroll to solution
        els.solutionBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function updateStats() {
        els.score.textContent = state.score;
        els.mobileScore.textContent = state.score;
        els.total.textContent = state.total;
        els.streak.textContent = state.streak;
        
        const accuracy = state.total > 0 ? Math.round((state.correct / state.total) * 100) : 0;
        els.accuracy.textContent = `${accuracy}%`;
    }

    function updateProgress() {
        const progress = state.total > 0 ? Math.min(100, (state.total % 10) * 10) : 0;
        els.progressFill.style.width = `${progress}%`;
    }

    function startTimer() {
        state.currentTime = state.timeLimit;
        els.timeLeft.textContent = state.currentTime;
        els.timer.style.color = 'var(--text-primary)';
        state.startTime = Date.now();
        
        state.timerInterval = setInterval(() => {
            state.currentTime--;
            els.timeLeft.textContent = state.currentTime;
            
            if (state.currentTime <= 10) {
                els.timer.style.color = 'var(--error-color)';
            } else if (state.currentTime <= 30) {
                els.timer.style.color = 'var(--warning-color)';
            }
            
            if (state.currentTime <= 0) {
                clearInterval(state.timerInterval);
                checkAnswer();
            }
        }, 1000);
    }

    function resetTimer() {
        clearInterval(state.timerInterval);
        els.timer.style.color = 'var(--text-primary)';
        state.currentTime = state.timeLimit;
    }

    function setDifficulty(level) {
        state.difficulty = level;
        
        document.querySelectorAll('.difficulty-btn').forEach(btn => {
            btn.classList.remove('active');
            if (btn.dataset.level === level) {
                btn.classList.add('active');
            }
        });
        
        switch(level) {
            case 'easy': state.timeLimit = 90; break;
            case 'medium': state.timeLimit = 60; break;
            case 'hard': state.timeLimit = 45; break;
        }
    }

    function showHint() {
        if (!state.currentQuestion) return;
        state.hintsUsed++;
        
        let hintMsg = state.currentQuestion.hint;
        
        // Add topic-specific hints
        if (state.currentTopic === 'indices') {
            hintMsg += '\n\nRemember:\n‚Ä¢ a·µê √ó a‚Åø = a·µê‚Å∫‚Åø\n‚Ä¢ a·µê √∑ a‚Åø = a·µê‚Åª‚Åø\n‚Ä¢ (a·µê)‚Åø = a·µêÀ£‚Åø';
        } else if (state.currentTopic === 'surds') {
            hintMsg += '\n\nRemember:\n‚Ä¢ ‚àö(ab) = ‚àöa √ó ‚àöb\n‚Ä¢ ‚àöa √ó ‚àöa = a\n‚Ä¢ Rationalize by multiplying by ‚àön/‚àön';
        } else if (state.currentTopic === 'logs') {
            hintMsg += '\n\nRemember:\n‚Ä¢ log_b(b‚Åø) = n\n‚Ä¢ log(a) + log(b) = log(ab)\n‚Ä¢ log_b(x) = n means b‚Åø = x';
        }
        
        alert(hintMsg);
    }

    function practiceSimilar() {
        generateQuestion();
    }

    // Event Listeners
    els.topic.addEventListener('change', generateQuestion);
    
    els.input.addEventListener("keypress", function(event) {
        if (event.key === "Enter" && !els.checkBtn.disabled) {
            checkAnswer();
        }
    });

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
        updateStats();
        setDifficulty('easy');
    });

    // Touch support
    document.addEventListener('touchstart', function() {}, {passive: true});
</script>

</body>
</html>
